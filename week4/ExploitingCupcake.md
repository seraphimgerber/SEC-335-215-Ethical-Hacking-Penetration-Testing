## Activity 4.1 - Exploiting Cupcake

The purpose of this activity is to give you a sense of some of the steps taken to recon, assess, exploit, achieve a foothold and elevate privileges on a system.

Through previous classes, we have discovered that the target organization (SHIRE) is running a webserver that purportedly runs a status application.

---

### Part 1 - Active Recon 

Q: The target is cupcake.shire.org at 10.0.5.23. What can you find out about the target? Make sure to check the top 100 TCP ports to see what ports are listening. For those ports that are open, run another scan that attempts to run version detection against the service port.

A: We ran an nmap scan using the syntax *nmap -sV -p 0-100 10.0.5.23*, which allowed us to see Port 22 was running SSH with OpenSSH version 5.3 and Port 80 was running a web server with Apache httpd on CentOS version 2.2.15.

<img width="577" height="126" alt="{B60CEA96-AF93-45AE-994D-9430B14C579E}" src="https://github.com/user-attachments/assets/ae4dfd60-2205-47d4-a1b4-5a98cc4520fc" />

Q: You should have the versions of at least two applications.  Go ahead and hit the internet and see if your group can find:

1. Related operating system (this is easy) 
2. Release (a bit harder)
3. What did you find and how did you find it?

A: The [Apache server](https://lists.apache.org/thread/7lw0j6023cfk35fy14q2f9tbgyn6lpmj) is an older version that was released on March 6, 2010, and it runs on CentOS. AlmaLinux and Rocky Linux are community-driven options that are very similar to CentOS. The [OpenSSH service](https://www.openssh.com/txt/release-5.3), specifically the 5.3 version, was released on October 1, 2009 and some variants that are very similar to it would be PuTTY or Dropbear SSH. 

---

## Part 2 - Dealing with Targets and Scans

Shows your sheet of nmap scan data against cupcake. Note, the scan in the demo did not show version detection. See if you can figure out how to do that. You will have at least two ports.

| IP | FQDN | PORT | PROTOCOL | SERVICE | VERSION |
| - | - | - | - | - | - |
| 10.0.5.23 | cupcake.shire.org | 22 | tcp | ssh | OpenSSH 5.3 |
| 10.0.5.23 | cupcake.shire.org | 80 | tcp | http | Apache httpd 2.2.15 | 

---

## Part 3 - Vulnerability Detection

Q: Based upon what you have learned about the operating system and the nature of the web service, leverage google and exploit db to find potential vulnerabilities. Take about 10 minutes to see what you can find and be prepared to present your findings. Focus on remote vulnerabilities that might give us a foothold on the target. What potential remote vulnerabilities did your team find?

A: Known vulnerabilities for OpenSSH:
- CVE-2010-4478 – Remote DoS via crafted requests
- CVE-2016-6515 – Information disclosure

Known vulnerabilities for Apache httpd 2.2.15:
- CVE-2011-3192 – Apache Range header DoS
- CVE-2012-0053 – Integer overflow in mod_proxy_ajp
- CVE-2017-3167 / CVE-2017-3169 – Authentication bypass & remote code execution in Apache 2.2.x
- CVE-2017-9798 (“Optionsbleed”) – Leak of server memory contents

---

## Part 4 - Remote Code Execution Vulnerability

Q: Just because your research indicated the potential of a vulnerability, let's see if we can confirm it both by hand and by use of an nmap script. Determine what the target's running kernel version (you would use the uname command for this). Provide a screenshot that shows the major and minor release of the kernel.

A: We used command *sudo nmap -sV -Pn -p 80 --script http-shellshock --script-args uri=/cgi-bin/status,cmd="echo ; echo ; /bin/uname -a" 10.0.5.23* to get the results of uname -a on Cupcake. 

<img width="616" height="431" alt="{046284A5-0925-4490-9CBE-44B08B7CE5A3}" src="https://github.com/user-attachments/assets/0d79b6ed-773c-4992-9fc2-ee6a53f5b1df" />

We also grabbed the results of /etc/passwd and saved it to a file called passwords.txt. 

<img width="600" height="364" alt="{DE578ADB-809C-4E79-9791-022935CDDA90}" src="https://github.com/user-attachments/assets/6346f116-8d53-4b75-a300-98d53b1d6a45" />

---

## Part 5 - The Foothold

Q: Do a case insensitive search of your search term on the contents of /usr/share/wordlists/rockyou.txt.gz. You may wish to extract the gzip or use zcat. Armed with the contents of /etc/passwd, let's see if we can build a list of likely passwords for the target account. You should end up with 28 passwords in your list. Provide a screenshot that shows how you generated the list as well as the list contents.

A: Rockyou.txt is a file of common passwords from the 2009 RockYou data breach. We used the command *gunzip* to unzip the gzip file then *mv*ed it to the same directory as our passwords.txt file from before. Then. we ran *grep -i 'samwise' rockyou.txt > passwords.txt to compare and move the results into our passwords file.

<img width="431" height="484" alt="{1534901E-A9A0-4E57-9BF4-EFD8A03A3DAF}" src="https://github.com/user-attachments/assets/d0ee0cea-337d-4a20-8556-2fccb81c7594" />


